setwd("/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao")
getwd()
vendas_regiao_rio <- read.csv("riodejaneiro.csv", sep = ";")
View(vendas_regiao_rio)
library(dplyr)
library(tidyverse)
View(vendas_regiao_rio)
Dim_Vendas_rio <- data.frame(
ID_Vendedor <- vendas_regiao_rio$ID.Vendedor,
Vendedor <- vendas_regiao_rio$Vendedor
)
View(Dim_Vendas_rio)
View(Dim_Vendas_rio)
setwd("/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao")
getwd()
vendas_belo_horizonte <- read.csv("belohorizonte.csv", sep = ";")
Dim_Vendedor_BH <- data.frame(
ID_Vendedor = vendas_belo_horizonte$ID.Vendedor,
Vendedor = vendas_belo_horizonte$Vendedor
)
## Visualização de Tabelas
View(Dim_Vendedor_BH)
vendas_rio_de_janeiro<- read.csv("riodejaneiro.csv", sep = ";")
vendas_rio_de_janeiro<- read.csv("riodejaneiro.csv", sep = ";")
Dim_Vendedor_RJ <- data.frame(
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
Vendedor = vendas_rio_de_janeiro$Vendedor
)
## Visualização de Tabelas
View(Dim_Vendedor_RJ)
setwd("/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao")
getwd()
vendas_rio_de_janeiro<- read.csv("riodejaneiro.csv", sep = ";")
View(vendas_rio_de_janeiro)
Dim_Vendedor_RJ <- data.frame(
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
Vendedor = vendas_rio_de_janeiro$Vendedor
)
Dim_Loja_RJ <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
Cidade = vendas_rio_de_janeiro$Cidade,
Estado = vendas_rio_de_janeiro$Estado
)
Dim_Produto_RJ <- data.frame(
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Categoria = vendas_rio_de_janeiro$Categoria,
Fabricante = vendas_rio_de_janeiro$Fabricante,
Produto = vendas_rio_de_janeiro$Produto,
Segmento = vendas_rio_de_janeiro$Segmento
)
Dim_Tempo <- data.frame(
Data_Venda = vendas_rio_de_janeiro$Data.Venda
)
TB_Fato <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Data_Venda = vendas_rio_de_janeiro$Data.Venda,
Valor_Venda = vendas_rio_de_janeiro$ValorVenda
)
## Remoção de Dados Duplicados
Dim_Vendedor_RJ <- Dim_Vendedor_BH %>% distinct(ID_Vendedor, .keep_all = TRUE)
Dim_Loja_RJ <- Dim_Loja_BH %>% distinct(Loja, .keep_all = TRUE)
setwd("/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao")
getwd()
vendas_rio_de_janeiro<- read.csv("riodejaneiro.csv", sep = ";")
View(vendas_rio_de_janeiro)
Dim_Vendedor_RJ <- data.frame(
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
Vendedor = vendas_rio_de_janeiro$Vendedor
)
Dim_Loja_RJ <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
Cidade = vendas_rio_de_janeiro$Cidade,
Estado = vendas_rio_de_janeiro$Estado
)
Dim_Produto_RJ <- data.frame(
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Categoria = vendas_rio_de_janeiro$Categoria,
Fabricante = vendas_rio_de_janeiro$Fabricante,
Produto = vendas_rio_de_janeiro$Produto,
Segmento = vendas_rio_de_janeiro$Segmento
)
Dim_Tempo <- data.frame(
Data_Venda = vendas_rio_de_janeiro$Data.Venda
)
TB_Fato <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Data_Venda = vendas_rio_de_janeiro$Data.Venda,
Valor_Venda = vendas_rio_de_janeiro$ValorVenda
)
## Remoção de Dados Duplicados
Dim_Vendedor_RJ <- Dim_Vendedor_RJ %>% distinct(ID_Vendedor, .keep_all = TRUE)
Dim_Loja_RJ <- Dim_Loja_RJ %>% distinct(Loja, .keep_all = TRUE)
## Visualização de Tabelas
View(Dim_Vendedor_RJ)
View(Dim_Loja_BH)
View(Dim_Loja_BH)
View(Dim_Loja_RJ)
vendas_rio_de_janeiro<- read.csv("riodejaneiro.csv", sep = ";")
View(vendas_rio_de_janeiro)
Dim_Vendedor_RJ <- data.frame(
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
Vendedor = vendas_rio_de_janeiro$Vendedor
)
Dim_Loja_RJ <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
Cidade = vendas_rio_de_janeiro$Cidade,
Estado = vendas_rio_de_janeiro$Estado
)
Dim_Produto_RJ <- data.frame(
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Categoria = vendas_rio_de_janeiro$Categoria,
Fabricante = vendas_rio_de_janeiro$Fabricante,
Produto = vendas_rio_de_janeiro$Produto,
Segmento = vendas_rio_de_janeiro$Segmento
)
Dim_Tempo <- data.frame(
Data_Venda = vendas_rio_de_janeiro$Data.Venda
)
TB_Fato <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Data_Venda = vendas_rio_de_janeiro$Data.Venda,
Valor_Venda = vendas_rio_de_janeiro$ValorVenda
)
## Remoção de Dados Duplicados
Dim_Vendedor_RJ <- Dim_Vendedor_RJ %>% distinct(ID_Vendedor, .keep_all = TRUE)
Dim_Loja_RJ <- Dim_Loja_RJ %>% distinct(Loja, .keep_all = TRUE)
## Visualização de Tabelas
View(Dim_Vendedor_RJ)
View(Dim_Loja_RJ)
View(Dim_Produto_RJ)
View(Dim_Tempo)
View(TB_Fato)
## Conexão com Banco de dados da Planilha de Vendas Região
db_rio <- dbConnect(SQLite(), dbname="/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao1.sqlite3")
## Conexão com Banco de dados da Planilha de Vendas Região
db_rio <- dbConnect(SQLite(), dbname="/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao.sqlite3")
Dim_Loja_RJ <- Dim_Loja_RJ %>% distinct(Loja, .keep_all = TRUE)
## Remoção de Dados Duplicados
Dim_Vendedor_RJ <- Dim_Vendedor_RJ %>% distinct(ID_Vendedor, .keep_all = TRUE)
## Conexão com Banco de dados da Planilha de Vendas Região
db_rio <- dbConnect(SQLite(), dbname="/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao.sqlite3")
library(RSQLite)
## Conexão com Banco de dados da Planilha de Vendas Região
db_rio <- dbConnect(SQLite(), dbname="/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao.sqlite3")
## Criação do Banco de Dados
dbWriteTable(db_rio, "fatos_rio", TB_Fato, overwrite = TRUE)
dbWriteTable(db_rio, "lojas_rio", Dim_Loja_BH, overwrite = TRUE)
setwd("/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao")
getwd()
library(dplyr)
library(tidyverse)
library(RSQLite)
vendas_rio_de_janeiro<- read.csv("riodejaneiro.csv", sep = ";")
View(vendas_rio_de_janeiro)
Dim_Vendedor_RJ <- data.frame(
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
Vendedor = vendas_rio_de_janeiro$Vendedor
)
Dim_Loja_RJ <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
Cidade = vendas_rio_de_janeiro$Cidade,
Estado = vendas_rio_de_janeiro$Estado
)
Dim_Produto_RJ <- data.frame(
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Categoria = vendas_rio_de_janeiro$Categoria,
Fabricante = vendas_rio_de_janeiro$Fabricante,
Produto = vendas_rio_de_janeiro$Produto,
Segmento = vendas_rio_de_janeiro$Segmento
)
Dim_Tempo_RJ <- data.frame(
Data_Venda = vendas_rio_de_janeiro$Data.Venda
)
TB_Fato_RJ <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Data_Venda = vendas_rio_de_janeiro$Data.Venda,
Valor_Venda = vendas_rio_de_janeiro$ValorVenda
)
## Remoção de Dados Duplicados
Dim_Vendedor_RJ <- Dim_Vendedor_RJ %>% distinct(ID_Vendedor, .keep_all = TRUE)
Dim_Loja_RJ <- Dim_Loja_RJ %>% distinct(Loja, .keep_all = TRUE)
## Visualização de Tabelas
View(Dim_Vendedor_RJ)
View(Dim_Loja_RJ)
View(Dim_Produto_RJ)
View(Dim_Produto_RJ)
View(TB_Fato_RJ)
## Conexão com Banco de dados da Planilha de Vendas Região
db_rio <- dbConnect(SQLite(), dbname="/home/gustavo/Projeto de Dados/Análise_R/Vendas_Regiao.sqlite3")
## Criação do Banco de Dados
dbWriteTable(db_rio, "fatos_rio", TB_Fato_RJ, overwrite = TRUE)
## Remoção de Dados Duplicados
Dim_Vendedor_RJ <- Dim_Vendedor_RJ %>% distinct(ID_Vendedor, .keep_all = TRUE)
)
)
TB_Fato_RJ <- data.frame(
Loja = vendas_rio_de_janeiro$Loja,
ID_Vendedor = vendas_rio_de_janeiro$ID.Vendedor,
ID_Produto = vendas_rio_de_janeiro$ID.Produto,
Data_Venda = vendas_rio_de_janeiro$Data.Venda,
Valor_Venda = vendas_rio_de_janeiro$ValorVenda
)
## Seleção das Colunas para o banco de dados
fatos_db_rio <- dbGetQuery(db_rio, "SELECT * FROM fatos_rio")
lojas_db_rio <- dbGetQuery(db_rio, "SELECT * FROM lojas_rio")
## Criação do Banco de Dados
dbWriteTable(db_rio, "fatos_rio", TB_Fato_RJ, overwrite = TRUE)
dbWriteTable(db_rio, "lojas_rio", Dim_Loja_RJ, overwrite = TRUE)
dbWriteTable(db_rio, "produtos_rio", Dim_Produto_RJ, overwrite = TRUE)
dbWriteTable(db_rio, "tempo_rio", Dim_Tempo_RJ, overwrite = TRUE)
dbWriteTable(db_rio, "vendedor_rio", Dim_Vendedor_RJ, overwrite = TRUE)
## Seleção das Colunas para o banco de dados
fatos_db_rio <- dbGetQuery(db_rio, "SELECT * FROM fatos_rio")
lojas_db_rio <- dbGetQuery(db_rio, "SELECT * FROM lojas_rio")
produtos_db_rio <- dbGetQuery(db_rio, "SELECT * FROM produtos_rio")
tempo_db_rio <- dbGetQuery(db_rio, "SELECT * FROM tempo_rio")
vendedor_db_rio <- dbGetQuery(db_rio, "SELECT * FROM vendedor_rio")
## Visualização de Dados pelo Banco de Dados Sqlite
View(fatos_db_rio)
View(lojas_db_rio)
View(produtos_db_bh)
View(produtos_db_rio)
View(tempo_db_rio)
View(vendedor_db_rio)
## 1 - Informe o total e média de Vendas por Categoria em BH
myquery1 <- "SELECT Categoria, SUM(Valor_Venda) AS Total, AVG(Valor_Venda) AS Média
FROM fatos_rio f INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto
GROUP BY p.Categoria"
consulta_categoria_produto <- dbGetQuery(db_rio, myquery1)
consulta_categoria_produto$Total <- paste("R$", format(consulta_categoria_produto$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_categoria_produto$Média <- paste("R$", format(consulta_categoria_produto$Média, decimal.mark = ",", big.mark = ".", nsmall = 3))
View(consulta_categoria_produto)
## 3 - Informe o total e média de Vendas por Vendedores em BH
myquery2 <- "SELECT Vendedor, SUM(Valor_venda) AS Total, AVG(Valor_Venda) AS Média
FROM fatos_rio f INNER JOIN vendedor_rio v ON f.ID_Vendedor = v.ID_Vendedor
GROUP BY v.Vendedor"
consulta_vendedor <- dbGetQuery(db_rio, myquery2)
View(consulta_vendedor)
## 2 - Informe o total e média de Vendas por Segmento em BH
myquery2 <- "SELECT Segmento, SUM(Valor_Venda) AS Total, AVG(Valor_Venda) AS Média
FROM fatos_rio f INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto
GROUP BY p.Segmento"
consulta_segmento_produto <- dbGetQuery(db_bh, myquery)
consulta_segmento_produto$Total <- paste("R$", format(consulta_segmento_produto$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
## 2 - Informe o total e média de Vendas por Segmento em BH
myquery2 <- "SELECT Segmento, SUM(Valor_Venda) AS Total, AVG(Valor_Venda) AS Média
FROM fatos_rio f INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto
GROUP BY p.Segmento"
consulta_segmento_produto <- dbGetQuery(db_bh, myquery)
consulta_segmento_produto <- dbGetQuery(db_rio, myquery)
## 2 - Informe o total e média de Vendas por Segmento em BH
myquery2 <- "SELECT Segmento, SUM(Valor_Venda) AS Total, AVG(Valor_Venda) AS Média
FROM fatos_rio f INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto
GROUP BY p.Segmento"
consulta_segmento_produto <- dbGetQuery(db_rio, myquery)
consulta_segmento_produto <- dbGetQuery(db_rio, myquery2)
consulta_segmento_produto$Total <- paste("R$", format(consulta_segmento_produto$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_segmento_produto$Média <- paste("R$", format(consulta_segmento_produto$Média, decimal.mark = ",", big.mark = ".", nsmall = 3))
View(consulta_segmento_produto)
## 3 - Informe o total e média de Vendas por Vendedores em BH
myquery3 <- "SELECT Vendedor, SUM(Valor_venda) AS Total, AVG(Valor_Venda) AS Média
FROM fatos_rio f INNER JOIN vendedor_rio v ON f.ID_Vendedor = v.ID_Vendedor
GROUP BY v.Vendedor"
consulta_vendedor <- dbGetQuery(db_rio, myquery3)
View(consulta_vendedor)
## 4 - Informe o total, média, desvio padrão de vendas por Cidade, Estado, Fabricante
myquery4 <- "SELECT Estado, Cidade, Fabricante, ROUND(SUM(Valor_Venda), 2) AS Total, ROUND(AVG(Valor_Venda), 2) AS Média,
ROUND(STDEV(Valor_Venda),2) AS Desvio_Padrão FROM fatos_bh f INNER JOIN lojas_rio l ON f.Loja = l.Loja
INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto GROUP BY Fabricante"
consulta_cidade_estado_fabricante <- dbGetQuery(db_rio, myquery)
consulta_cidade_estado_fabricante <- dbGetQuery(db_rio, myquery4)
consulta_cidade_estado_fabricante$Total <- paste("R$", format(consulta_cidade_estado_fabricante$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_cidade_estado_fabricante <- dbGetQuery(db_rio, myquery4)
consulta_cidade_estado_fabricante$Total <- paste("R$", format(consulta_cidade_estado_fabricante$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_cidade_estado_fabricante$Média <- paste("R$", format(consulta_cidade_estado_fabricante$Média, decimal.mark = ",", big.mark = ".", nsmall = 3))
View(consulta_cidade_estado_fabricante)
## 4 - Informe o total, média, desvio padrão de vendas por Cidade, Estado, Fabricante
myquery4 <- "SELECT Estado, Cidade, Fabricante, ROUND(SUM(Valor_Venda), 2) AS Total, ROUND(AVG(Valor_Venda), 2) AS Média,
ROUND(STDEV(Valor_Venda),2) AS Desvio_Padrão FROM fatos_bh f INNER JOIN lojas_rio l ON f.Loja = l.Loja
INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto GROUP BY Fabricante"
View(consulta_cidade_estado_fabricante)
## 4 - Informe o total, média, desvio padrão de vendas por Cidade, Estado, Fabricante
myquery4 <- "SELECT Estado, Cidade, Fabricante, ROUND(SUM(Valor_Venda), 2) AS Total, ROUND(AVG(Valor_Venda), 2) AS Média,
ROUND(STDEV(Valor_Venda),2) AS Desvio_Padrão FROM fatos_rio f INNER JOIN lojas_rio l ON f.Loja = l.Loja
INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto GROUP BY Fabricante"
consulta_cidade_estado_fabricante <- dbGetQuery(db_rio, myquery4)
consulta_cidade_estado_fabricante$Total <- paste("R$", format(consulta_cidade_estado_fabricante$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_cidade_estado_fabricante$Média <- paste("R$", format(consulta_cidade_estado_fabricante$Média, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_cidade_estado_fabricante$Desvio_Padrão <- paste("R$", format(consulta_cidade_estado_fabricante$Desvio_Padrão, decimal.mark = ",", big.mark = ".", nsmall = 3))
View(consulta_cidade_estado_fabricante)
## 5 - Informe o total, média, variancia de vendas por Cidade, Estado e Vendedor, Segmento e Categoria
myquery5 <- "SELECT Estado, Cidade, Segmento, Categoria, Vendedor, ROUND(SUM(Valor_Venda), 2) AS Total,
ROUND(AVG(Valor_Venda), 2) AS Média, ROUND(STDEV(Valor_Venda),2) AS Desvio_Padrão FROM fatos_rio f
INNER JOIN lojas_rio l ON f.Loja = l.Loja
INNER JOIN produtos_rio p ON f.ID_Produto = p.ID_Produto
INNER JOIN vendedor_rio v ON f.ID_Vendedor = v.ID_Vendedor GROUP BY Vendedor"
consulta_cidade_estado_segmento_vendedor <- dbGetQuery(db_rio, myquery)
consulta_cidade_estado_segmento_vendedor <- dbGetQuery(db_rio, myquery5)
consulta_cidade_estado_segmento_vendedor$Total <- paste("R$", format(consulta_cidade_estado_segmento_vendedor$Total, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_cidade_estado_segmento_vendedor$Média <- paste("R$", format(consulta_cidade_estado_segmento_vendedor$Média, decimal.mark = ",", big.mark = ".", nsmall = 3))
consulta_cidade_estado_segmento_vendedor$Desvio_Padrão <- paste("R$", format(consulta_cidade_estado_segmento_vendedor$Desvio_Padrão, decimal.mark = ",", big.mark = ".", nsmall = 3))
View(consulta_cidade_estado_segmento_vendedor)
